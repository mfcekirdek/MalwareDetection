import lief

top_resolved_api_files = ["msxml3.dll", "winsta.dll", "icm32.dll", "sqlite3.dll",
"msls31.dll", "pstorec.dll", "mpr.dll", "iertutil.dll",
"crypt32.dll", "clbcatq.dll", "advapi32.dll", "ole32.dll",
"ws2_32.dll", "davclnt.dll", "linkinfo.dll", "mlang.dll",
"sqlite.dll", "imgutil.dll", "setupapi.dll", "iphlpapi.dll",
"mswsock.dll", "avicap32.dll", "nss3.dll", "msvcrt.dll",
"rpcrt4.dll", "ieui.dll", "ieproxy.dll", "urlmon.dll",
"odbc32.dll", "apphelp.dll", "dnsapi.dll", "msv1_0.dll",
"oleaut32.dll", "netapi32.dll", "ntdll.dll", "xpshims.dll",
"shdocvw.dll", "mfc42.dll", "ntlanman.dll", "hnetcfg.dll",
"acroiehelper.dll", "comdlg32.dll", "rtutils.dll", "usp10.dll",
"uxtheme.dll", "winspool.drv", "rasman.dll", "mfc42u.dll",
"comctl32.dll", "winrnr.dll", "msctfime.ime", "samlib.dll",
"rasapi32.dll", "user32.dll", "gdi32.dll", "ogl.dll",
"shlwapi.dll", "msimg32.dll", "ieframe.dll", "mshtml.dll",
"mscms.dll", "actxprxy.dll", "msvbvm60.dll", "winmm.dll",
"msctf.dll", "dciman32.dll", "wbemsvc.dll", "xmllite.dll",
"sensapi.dll", "psapi.dll", "mso.dll", "faultrep.dll",
"kernel32.dll", "drprov.dll", "msi.dll", "shell32.dll",
"acgenral.dll", "userenv.dll", "gdiplus.dll", "wintrust.dll",
"wshtcpip.dll", "imm32.dll", "ntmarta.dll", "olepro32.dll",
"rasadhlp.dll", "sqmapi.dll", "scrrun.dll", "winhttp.dll",
"fastprox.dll", "version.dll", "wininet.dll", "shfolder.dll",
"cscdll.dll", "sxs.dll", "msvfw32.dll", "secur32.dll"]

def print_export(binary):
    print("== Exported functions of DLL ==")
    exports = binary.get_export()
    entries = exports.entries
    entries = sorted(entries, key=lambda e : e.ordinal)
    for entry in entries:
        print(entry.name)

for dll in top_resolved_api_files:
    # Load targets
    print("../dlls/"+dll)
    dll = lief.parse("../dlls/"+dll)
    print("####################################################")
    print_export(dll)